---
â­•ì²« í•™ìŠµë‚ : 2024-09-25
â­•ê³¼ëª©: AWS
â­•êµìž¬: Ultimate AWS Certified SysOps Administrator Associate 2024
â¤1ì¼ë³µìŠµì—¬ë¶€: true
ðŸ§¡4ì¼ë³µìŠµì—¬ë¶€: true
ðŸ’›7ì¼ë³µìŠµì—¬ë¶€: true
ðŸ’š14ì¼ë³µìŠµì—¬ë¶€: true
ðŸ§ ìž¥ê¸°ê¸°ì–µ: false
ë³µìŠµ: ì¶”ê°€ ë³µìŠµ
ðŸ›‘ì²«ë‚ : "âœì²«ë‚  : 2024/09/25"
ðŸ›‘ì˜¤ëŠ˜: "â°ì˜¤ëŠ˜ : 2024/10/27"
ðŸ›‘ì²«í•™ìŠµí›„ ëª‡ì¼ì§¸?: ì²« í•™ìŠµ í›„ â¤32ì¼ì§¸â¤
ðŸ›‘4ì¼í›„: "ðŸ¥‰4ì¼ë’¤ : 2024/09/29"
ðŸ›‘7ì¼í›„: "ðŸ¥ˆ7ì¼ë’¤ : 2024/10/02"
ðŸ›‘14ì¼í›„: "ðŸ¥‡14ì¼ë’¤ : 2024/10/09"
4ì¼í›„: "@2024ë…„ 9ì›” 29ì¼"
4ì¼í›„(text): 2024/09/29
7ì¼í›„: "@2024ë…„ 10ì›” 2ì¼"
7ì¼í›„(text): 2024/10/02
14ì¼í›„: "@2024ë…„ 10ì›” 9ì¼"
14ì¼í›„(text): 2024/10/09
ì˜¤ëŠ˜1: "@2024ë…„ 10ì›” 27ì¼ ì˜¤í›„ 2:01"
ì˜¤ëŠ˜2: 2024/10/27
ì²«í•™ìŠµë‚ text: 2024/09/25
ì˜¤ëŠ˜ê³¼ ì²«í•™ìŠµë‚  ì‚¬ì´: "32"
ì‚¬ì´: "32"
"1ì¼ì°¨ë³µìŠµì—¬ë¶€1,0": "1"
"4ì¼ì°¨ë³µìŠµì—¬ë¶€1,0": "1"
"7ì¼ì°¨ë³µìŠµì—¬ë¶€1,0": "1"
"ìž¥ê¸°ê¸°ì–µì €ìž¥ì—¬ë¶€1,0": "0"
í•™ìŠµë¥ : "0.6"
ì§„í–‰ë°”: ðŸŸ©ðŸŸ©ðŸŸ©ðŸŸ©ðŸŸ©ðŸŸ©â¬œâ¬œâ¬œâ¬œ 60%
---
[[AWS]] [[Ultimate AWS Certified SysOps Administrator Associate 2024]] [[CloudFormation]] [[IaC]]
### ë‹¨ì„œ ì§ˆë¬¸

- CloudFormationì´ ë­ì•¼?
    
    CloudFormationì€ ì„ ì–¸í˜• í”„ë¡œê·¸ëž˜ë°ì„ í†µí•´ì„œ ì¸í”„ë¼ë¥¼ ì •ì˜í•˜ëŠ” IaCìž…ë‹ˆë‹¤.
    
- CloudFormation ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„  templateì„ ì–´ë–¡í•˜ë‚˜?
    
    templateì„ S3 Bucketì— ì—…ë¡œë“œí•˜ê³  ì´í›„ì—” í•´ë‹¹ ë²„í‚·ì„ ì°¸ì¡°í•˜ëŠ” Stackì„ CloudFormationì—ì„œ ë§Œë“­ë‹ˆë‹¤. templateì€ ì‚­ì œí•˜ê³  ìž¬ì—…ë¡œë“œí•˜ëŠ” ê²ƒì´ ì•„ë‹Œ ì—…ë°ì´íŠ¸ë¥¼ í†µí•´ ë²„ì €ë‹ì„ ì§„í–‰í•©ë‹ˆë‹¤.
    
- CloudFormationì˜ ìž¥ì 
    
    **IAC**
    
    - ì½”ë“œë¡œ ìž‘ì„±ë˜ë¯€ë¡œ ì¸í”„ë¼ ìž‘ì„±ì„ ì½”ë“œë¦¬ë·°ë¡œ ëŒ€ì²´ ê°€ëŠ¥
    - ì½”ë“œë¥¼ í†µí•´ ìƒì„±ë˜ë¯€ë¡œ ì½”ë“œë¥¼ í†µí•œ ë™ìž‘ì´ ì¼ê´€ì„± ìžˆë‹¤.
    
    **ë¹„ìš©**
    
    - stackì€ íƒœê·¸ë¥¼ í†µí•œ ì‹ë³„ìžë¥¼ ê°€ì§€ë¯€ë¡œ í•´ë‹¹ íƒœê·¸ë¥¼ í†µí•´ì„œ ë¹„ìš© ì¸¡ì • ê°€ëŠ¥
    - template ì„ ì–¸ëœ ìžì›ì„ í†µí•´ì„œ ìµœì¢… ë¹„ìš© ì˜ˆìƒ ê°€ëŠ¥
- CloudFormationì˜ Parametersëž€?
    - ìž…ë ¥ ê°’ì„ AWS CloudFormation Templateì— ì „ë‹¬í•˜ê¸° ìœ„í•´ ì‚¬ìš©
- CloudFormationì˜ MappingsëŠ”?
    - Key, Valueì˜ ìŒìœ¼ë¡œ CloudFormationì— í•˜ë“œ ì½”ë”© ë˜ì–´ ìžˆìŒ.
- CloudFormationì˜ Parametersì™€ Mappingsì˜ ì°¨ì´ì ì€?
    
    **ìž‘ì„± ì‹œì **
    
    ParametersëŠ” CloudFormationì´ ë¦¬ì†ŒìŠ¤ë¥¼ ë§Œë“¤ ë•Œ
    
    MappingsëŠ” CloudFormationì˜ Templateì„ ìž‘ì„±í•  ë•Œ
    
      
    
    **ë™ì  vs ì •ì **
    
    ParametersëŠ” ë™ì ìœ¼ë¡œ ìž…ë ¥ì„ ë°›ì„ ìˆ˜ ìžˆë‹¤.
    
    MappingsëŠ” í…œí”Œë¦¿ì˜ ê°’ì„ ì‚¬ìš©
    
- Parametersì™€ Mappingì˜ ì‚¬ìš© ë°©ë²•
    
    CloudFormation yaml íŒŒì¼ ë‚´ì— Mappingsë¡œ ìž‘ì„± í›„ì— FindInMap Intrinsic Functionì¸ FindInMap í•¨ìˆ˜ë¡œ ì¡°íšŒ
    
- CloudFormationì—ì„œ Create Stack ì‹¤íŒ¨ ì‹œì— AWSì—ì„œ ì·¨í•˜ëŠ” ì¡°ì¹˜ëŠ”?
    
    Create Stack ìƒì„± ì‹¤íŒ¨ ì‹œì— ê¸°ë³¸ ëŒ€ì²˜ëŠ” ë¦¬ì†ŒìŠ¤ ì „ì²´ ì‚­ì œë‹¤. ë§Œì•½ì—, íŠ¸ëŸ¬ë¸” ìŠˆíŒ…ì„ ì›í• í•˜ê²Œ ì§„í–‰í•˜ë ¤ë©´ ë¦¬ì†ŒìŠ¤ ì „ì²´ ì‚­ì œ ì„¤ì •ì„ Disableí•˜ìž. í˜¹ì€ ë‹¨ìˆœí•˜ê²Œ ë¡œê·¸ë¥¼ í†µí•´ í•´ê²°í•´ë„ ëœë‹¤.
    
- CloudFormationì—ì„œ ë¡¤ë°± ì‹¤íŒ¨ ì‹œì— ëŒ€ì‘ ì¡°ì¹˜ëŠ”?
    
    ë¦¬ì†ŒìŠ¤ì— ëŒ€í•´ ì¡°ì¹˜ë¥¼ ì·¨í•œ í›„ì— CloudFormationì—ì„œ ContinueUpdateRollback APIë¥¼ í˜¸ì¶œí•œë‹¤.
    
- CloudFormationì—ì„œ Outputsì´ëž€?
    
    ë‹¤ë¥¸ ìŠ¤íƒì—ì„œ ë§Œë“¤ì–´ì§„ ê°’ì„ ì‚¬ìš©í•˜ê³  ì‹¶ì„ ë•Œ, í•´ë‹¹ ìŠ¤íƒì—ì„œ ê°’ì„ Exportí•˜ê³  Outputì„ í†µí•´ ì‚¬ìš©í•  ìˆ˜ ìžˆë‹¤.
    
    ```JavaScript
    !ImportValue (ì‚¬ìš©í• ê°’)
    ```
    
- CloudFormation Capabilities
    
    CloudFormationì—ì„œ íŠ¹ì • ë¦¬ì†ŒìŠ¤(IAM)ë¥¼ ìƒì„±í•˜ê±°ë‚˜ Macroë¥¼ í†µí•´ ë™ì ìœ¼ë¡œ ë¦¬ì†ŒìŠ¤ë¥¼ êµ¬ì¶•í•˜ê¸° ìœ„í•´ì„  Capabilitiesë¥¼ ë¶€ì—¬í•©ë‹ˆë‹¤.
    
    **InsufficientCapabilitiesException**ì€ Capabilityê°€ ì—†ëŠ” ìƒíƒœì—ì„œ í…œí”Œë¦¿ì—ì„œ í•´ë‹¹ ê¶Œí•œì´ í•„ìš”í•œ ë¦¬ì†ŒìŠ¤ë¥¼ ìƒì„±í•˜ë©´ ë°œìƒí•˜ëŠ” ì˜ˆì™¸ìž…ë‹ˆë‹¤.
    
- Deletion Policyëž€?
    
    í´ë¼ìš°ë“œ í¬ë©”ì´ì…˜ì—ì„œ ë¦¬ì†ŒìŠ¤ê°€ ì œê±°ë˜ì—ˆê±°ë‚˜ Template íŒŒì¼ì´ ì‚­ì œëì„ ë•Œ, ë¦¬ì†ŒìŠ¤ë“¤ì„ ì–´ë–»ê²Œ ì²˜ë¦¬í• ì§€ ì •í•˜ëŠ” ì •ì±…. (ex: Delete, Retain, Snapshot)
    
- Stack Policyëž€?
    
    ìŠ¤íƒì— í¬í•¨ëœ ë¦¬ì†ŒìŠ¤ê°€ ì—…ë°ì´íŠ¸ ë  ë•Œ ìƒëžµí• ì§€ ì—…ë°ì´íŠ¸í• ì§€ ì •í•˜ëŠ” ì •ì±…
    
- cfn-initê³¼ cfn-signalì´ëž€?
    
    cfn-init: CloudFormation initìœ¼ë¡œ EC2ì—ì„œ CloudFormationìœ¼ë¡œë¶€í„° ë°›ëŠ” ìŠ¤í¬ë¦½íŠ¸ë‹¤.
    
    cfn-signal: cfn-init ê²°ê³¼ë¥¼ CloudFormationì— ì „ì†¡í•˜ëŠ” ê²ƒ
    

### í•µì‹¬ í•„ê¸°

- ì „ì²´ ë‚´ìš© ì ‘ê¸°
    - [DVA] Cloudformation - Overview
        - AWS CloudFormation
            
            ![[image 44.png]]
            
            - CloudFormationì€ ì„ ì–¸ì ìœ¼ë¡œ AWS ì¸í”„ë¼ë¥¼ ì •ì˜í•˜ëŠ” ë°©ë²•
            - ì„ ì–¸í•˜ë©´ í•´ë‹¹ ë¦¬ì†ŒìŠ¤ë“¤ì„ ìˆœì„œì™€ ì„¤ì •ì— ë”°ë¼ì„œ ìžì›ë“¤ì„ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤.
        - CloudFormation - Template Example
            
            ![[image 1 17.png]]
            
              
            
        - Benefits of AWS CloudFormation(1/2)
            
            ![[image 2 15.png]]
            
            CloudFormationì˜ ì´ì 
            
            - IaC
            - ë¹„ìš©
                - ë¹„ìš© ì˜ˆì¸¡
                - ë¹„ìš© ì ˆê° ì „ëžµ: ìžë™ì‚­ì œ
        - Benefits of AWS CloudFormation(2/2)
            
            ![[image 3 14.png]]
            
            - ìƒì‚°ì„±
        - How CloudFormation Works
            
            ![[image 4 14.png]]
            
            - S3ì— í…œí”Œë¦¿ ì—…ë¡œë“œ í›„ CloudFormationì—ì„œ ì°¸ì¡°
            - íŒŒì¼ ìˆ˜ì • ë¶ˆê°€í•˜ë©° ìƒˆë¡œìš´ ë²„ì „ì„ ì—…ë¡œë“œí•˜ëŠ” ê²ƒìœ¼ë¡œë§Œ ê°€ëŠ¥
            - Stackì€ ì´ë¦„ìœ¼ë¡œ ì‹ë³„
            - Stackì„ ì‚­ì œí•˜ë©´ CloudFormationìœ¼ë¡œ ë§Œë“  ëª¨ë“  ìš”ì†Œë“¤ì´ ì‚­ì œë¨.
        - Deploying CloudFormation Templates
            
            ![[image 5 11.png]]
            
            - ë©”ë‰´ì–¼ ë°©ë²•
                1. ì½”ë“œ ì—ë””í„°ì—ì„œ í…œí”Œë¦¿ ìˆ˜ì •
                2. consoleì„ í†µí•´ì„œ íŒŒëžŒì„ ì „ë‹¬
            - ìžë™í™”
                1. YAML íŒŒì¼ ìž‘ì„±
                2. AWS CLIë¡œ ë°°í¬í•˜ê±°ë‚˜ CD(Continuous Delivery) íˆ´ ì‚¬ìš©
        - CloudFormation - Building Blocks
            
            ![[image 6 11.png]]
            
            - í…œí”Œë¦¿ êµ¬ì„± ìš”ì†Œ
                - AWSTemplateFormatVersion: í…œí”Œë¦¿ ë²„ì „ ëª…ì‹œ â€œ2010-09-09â€
                - Description: í…œí”Œë¦¿ ì„¤ëª…
                - Resources: ì‚¬ìš©í•  ë¦¬ì†ŒìŠ¤
                - Parameters: í…œí”Œë¦¿ì„ ìœ„í•œ ë™ì  ìž…ë ¥ê°’
                - Mappings: í…œí”Œë¦¿ì„ ìœ„í•œ ì •ì  ë³€ìˆ˜ë“¤
                - Outputs: ë‹¤ë¥¸ ë¦¬ì†ŒìŠ¤ì—ì„œ ë§Œë“¤ì–´ì§„ ê°’ì„ ì°¸ì¡°í•  ë•Œ ì‚¬ìš© (ë§Œë“  ì‚¬ëžŒì€ Export)
                - Conditionals: ë¦¬ì†ŒìŠ¤ ìƒì‚°ì„ ìœ„í•œ ì¡°ê±´ë¬¸
            - Templateâ€™s ë„ìš°ë¯¸
                - References
                - Functions
        - Introductory Example
            
            ![[image 7 9.png]]
            
              
            
    - [DVA] YAML Crash Course
        
        ![[image 8 9.png]]
        
          
        
    - [DVA] CloudFormation - Resources
        
        ![[image 9 9.png]]
        
        - ResourceëŠ” CloudFormationì˜ í•µì‹¬ìœ¼ë¡œ í•„ìˆ˜í•­ëª©
        - ë¦¬ì†ŒìŠ¤ í¼ í˜•íƒœëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.
            - service-provider::service-name::data-type-name
        
        ![[image 10 8.png]]
        
          
        
        ![[image 11 8.png]]
        
          
        
        ![[image 12 8.png]]
        
        **Q.** ë™ì ìœ¼ë¡œ ê°€ë³€í•˜ëŠ” ê°œìˆ˜ë§Œí¼ ë¦¬ì†ŒìŠ¤ë¥¼ ë§Œë“¤ ìˆ˜ ìžˆë‚˜?
        
        **A.** ê°€ëŠ¥. ì´ ì½”ìŠ¤ì—ì„œ ì•ˆë‹¤ë£¸
        
          
        
        **Q.** ëª¨ë“  AWS ë¦¬ì†ŒìŠ¤ë¥¼ ì§€ì›í•˜ë‚˜?
        
        **A.** ê±°ì˜ ë‹¤
        
          
        
    - [DVA] CloudFormation - Parameters
        
        ![[image 13 8.png]]
        
        **CloudFormation - Parameters**
        
        - CloudFormationì˜ ìž…ë ¥ ê°’ì„ ì „ë‹¬í•˜ê¸° ìœ„í•´ ì‚¬ìš©
        - ì–¸ì œ ì“°ëƒ?
            - ìž…ë ¥ ê°’ì„ í†µí•œ í…œí”Œë¦¿ ìž¬ì‚¬ìš©
            - í…œí”Œë¦¿ì— ì‚¬ìš©ë  ê°’ì´ ë™ì ìœ¼ë¡œ ì ìš©ë˜ì–´ì•¼ í•  ë•Œ
        - ìž…ë ¥ì„ ì£¼ëŠ” ë°©ë²• AWS clië‚˜ AWS System Managerë¥¼ í†µí•´ì„œ
        
        ![[image 14 7.png]]
        
          
        
        ![[image 15 7.png]]
        
          
        
        ![[image 16 6.png]]
        
          
        
        ![[image 17 5.png]]
        
          
        
        ![[image 18 5.png]]
        
        - AWS::AccountId
        - AWS:Region
        - AWS:StackId
        - AWS:StackName
        - AWS::NotificationARNs
        - AWS: NoValue
        
          
        
    - [DVA] CloudFormation - Mappings
        
        ![[image 19 5.png]]
        
        - MappingsëŠ” CloudFormationê³¼ ê°™ì´ ìž‘ì„±ë˜ì–´ ìžˆìŒ. (Parametersì™€ ê°™ì´ ìž…ë ¥ ê°’ì„ ë°›ëŠ” ê²Œ ì•„ë‹ˆë‹¤)
        - ì„œë¡œ ë‹¤ë¥¸ í™˜ê²½ì—ì„œ íŽ¸ë¦¬í•˜ë‹¤.
        - ëª¨ë“  ê°’ì€ Templateì— í•˜ë“œì½”ë”©ë˜ì–´ ìžˆìŒ
        
        ![[image 20 5.png]]
        
          
        
        ![[image 21 5.png]]
        
          
        
    - [DVA] CloudFormation - Outputs & Exports
        
        ![[image 22 4.png]]
        
        - Outputì€ ì„ íƒì  ì¶œë ¥ ê°’ë“¤ì„ ì„ ì–¸í•œë‹¤. ì´ë¥¼ ë‹¤ë¥¸ Stackì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìžˆë‹¤.
        - Outputsë¥¼ AWS Consoleì´ë‚˜ AWS CLIë¥¼ í†µí•´ ì‚¬ìš© ê°€ëŠ¥í•©ë‹ˆë‹¤.
        - ë„¤íŠ¸ì›Œí¬ë¥¼ CloudFormationìœ¼ë¡œ ì •ì˜í•˜ê³  Outputì„ í†µí•´ VPC IPë‚˜ Subnet IDë¥¼ ì‚¬ìš©í•  ìˆ˜ ìžˆë‹¤.
        - ìŠ¤íƒë¼ë¦¬ í˜‘ë™í•˜ê¸° ìœ„í•´ ê°€ìž¥ ì¢‹ì€ ë°©ë²•ìž…ë‹ˆë‹¤.
        
        ![[image 23 4.png]]
        
          
        
        ![[image 24 4.png]]
        
          
        
    - [DVA] CloudFormation - Conditions
        - CloudFormation - Conditions
            
            ![[image 25 4.png]]
            
            - ì¡°ê±´ì— ë”°ë¼ì„œ ë¦¬ì†ŒìŠ¤ ìƒì„±ì´ë‚˜ Outputsë¥¼ ì¡°ì ˆí•œë‹¤.
            - ì–´ë–¤ ê²ƒë„ ì¡°ê±´ì´ ë  ìˆ˜ ìžˆì§€ë§Œ ë‹¤ìŒ 3ê°€ì§€ê°€ ì¼ë°˜ì ì¸ ì‚¬ìš© ë°©ë²•ì´ë‹¤.
                - í™˜ê²½ (dev / test / prod)
                - AWS Region
                - Parameter Value
            - Conditionì€ ë‹¤ë¥¸ Conditionì´ë‚˜ parameter value, mappingì„ ì°¸ì¡°í•  ìˆ˜ ìžˆë‹¤.
        - How to define a Condition
            
            ![[image 26 4.png]]
            
              
            
        - How to use a Condition
            
            ![[image 27 4.png]]
            
            - Conditionì€ resource / outputs ê¸°íƒ€ ë“±ë“± ë‹¤ì–‘í•œ ê³³ì— ì ìš© ê°€ëŠ¥í•˜ë‹¤.
    - [DVA] CloudFormation - Intrinsic Functions
        - CloudFormation - Intrinsic Functions
            
            ![[image 28 2.png]]
            
              
            
        - Intrinsic Functions
            - Fn::Ref
                
                ![[image 29 2.png]]
                
                Fn::Ref
                
                - Parametersì— ì‚¬ìš©í•˜ë©´ Parameter ê°’ì„ ê°€ì ¸ì˜¨ë‹¤.
                - Resourcesì— ì‚¬ìš©í•˜ë©´ Resource IDë¥¼ ê°€ì ¸ì˜¨ë‹¤.
            - Fn:GetAtt
                
                ![[image 30 2.png]]
                
                Fn:GetAtt
                
                - AttributeëŠ” ëª¨ë“  ë¦¬ì†ŒìŠ¤ì™€ ê²°í•©ë˜ì–´ ìžˆë‹¤.
                - Attributeë¥¼ í™•ì¸í•˜ë ¤ë©´ AWS ê³µì‹ ë¬¸ì„œë¥¼ ë´ë¼
                - !GetAtt EC2Instance.AvailabilityZoneì€ EC2 ì¸ìŠ¤í„´ìŠ¤ì˜ AZë¥¼ ê°€ì ¸ì˜¨ë‹¤.
            - FindInMap
                
                ![[image 31 2.png]]
                
                Fn::FindInMap
                
                - Mappingsì—ì„œ Key ê°’ì„ í†µí•´ì„œ ê°’ì„ ì¡°íšŒ ê°€ëŠ¥
            - Fn::ImportValue
                
                ![[image 32 2.png]]
                
                **Fn::ImportValue**
                
                - ë‹¤ë¥¸ ìŠ¤íƒì—ì„œ Export ëœ ê°’ì„ Import í•  ìˆ˜ ìžˆë‹¤.
            - Fn::Base64
                
                ![[image 33 2.png]]
                
                **Fn::Base64**
                
                - Stringì„ Base64ë¡œ ë³€ê²½í•œë‹¤.
            - Fn::Condition Functions
                
                ![[image 34 2.png]]
                
                  
                
    - [DVA] CloudFormation - Rollbacks
        
        ![[image 35 2.png]]
        
        **Rollbacks**
        
        - Stack ìƒì„± ì‹¤íŒ¨ ì‹œ:
            - ê¸°ë³¸ ì„¤ì •: ëª¨ë“  ê²Œ ë¡¤ë°± ëœë‹¤.
            - ë¡¤ë°± ì„¤ì •ì„ êº¼ì„œ íŠ¸ëŸ¬ë¸” ìŠˆíŒ…ì„ í•  ìˆ˜ ìžˆë‹¤.
        - Stack ì—…ë°ì´íŠ¸ ì‹¤íŒ¨ ì‹œ:
            - ì´ì „ ìƒíƒœë¡œ ëŒì•„ê°„ë‹¤.
            - ë¡œê·¸ë¡œ ì—ëŸ¬ í™•ì¸ ê°€ëŠ¥
        - ë¡¤ë°± ì‹¤íŒ¨ ì‹œ ëŒ€ì²˜ ë°©ë²•ì€?
            - ContinueUpdateRollback APIë¥¼ í˜¸ì¶œ
    - [DVA] CloudFormation - Service Role
        
        ![[image 36 2.png]]
        
        **Service Role**
        
        - CloudFormationì´ User ì•¡ì…˜ì— ë”°ë¼ ìŠ¤íƒ ìƒì„±/ì—…ë°ì´íŠ¸/ì‚­ì œë¥¼ í•  ìˆ˜ ìžˆê²Œ í—ˆìš©í•œë‹¤.
        - CloudFormationìœ¼ë¡œ ë§Œë“œë ¤ëŠ” í•´ë‹¹ ë¦¬ì†ŒìŠ¤ ê¶Œí•œì„ ì¶”ê°€í•œë‹¤.
        
        ```JavaScript
        // CloudFormationì˜ ìžê²©ì¦ëª…ê¸°ë°˜ì •ì±…
        {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Effect": "Allow",
              "Action": [
                "s3:*Bucket"
              ],
              "Resource": "*"
            }
          ]
        }
        ```
        
        - ì–¸ì œì“°ëƒ?
            - ìµœì†Œí•œì˜ ê¶Œí•œì„ ì£¼ê³  ì‹¶ì„ ë•Œ
        
        **Service Role ë‚´ê°€ ì´í•´í•œ ë‚´ìš©**
        
        - Stackì„ ë§Œë“œëŠ” ìœ ì €ëŠ” iam:PassRoleì´ëž‘ CloudFormationì˜ ê¶Œí•œì´ ìžˆì–´ì•¼í•œë‹¤.
        - CloudFormationì€ ìžê²©ì¦ëª…ê¸°ë°˜ì •ì±…ìœ¼ë¡œ CloudFormation í…œí”Œë¦¿ì„ í†µí•´ ë§Œë“¤ ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ ê¶Œí•œì´ ìžˆì–´ì•¼ í•œë‹¤.
        
        - ìžê²©ì¦ëª…ê¸°ë°˜ vs ë¦¬ì†ŒìŠ¤ ê¸°ë°˜
            
            ### 1. **ìžê²© ê¸°ë°˜ ì •ì±… (Identity-Based Policy)**
            
            - **ì ìš© ëŒ€ìƒ**: IAM ì‚¬ìš©ìž(User), IAM ê·¸ë£¹(Group), ë˜ëŠ” IAM ì—­í• (Role).
            - **ì‚¬ìš© ë°©ë²•**: íŠ¹ì • ìœ ì €, ê·¸ë£¹, ì—­í• ì—ê²Œ ì–´ë–¤ ë¦¬ì†ŒìŠ¤ì— ì ‘ê·¼í•  ìˆ˜ ìžˆëŠ”ì§€, ê·¸ë¦¬ê³  ì–´ë–¤ ìž‘ì—…(ì˜ˆ: EC2 ì¸ìŠ¤í„´ìŠ¤ ì‹œìž‘, S3 ë²„í‚· ì½ê¸° ë“±)ì„ ìˆ˜í–‰í•  ìˆ˜ ìžˆëŠ”ì§€ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.
            - **ì˜ˆì‹œ ìƒí™©**: "ì´ IAM ì—­í• ì´ ëª¨ë“  S3 ë²„í‚·ì— ì ‘ê·¼í•  ìˆ˜ ìžˆë„ë¡ ì„¤ì •"í•˜ëŠ” ê²½ìš° ìžê²© ê¸°ë°˜ ì •ì±…ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
            
            **ì˜ˆì‹œ: IAM ì—­í• ì— ì ìš©ëœ ìžê²© ê¸°ë°˜ ì •ì±…**
            
            ```JSON
            json
            ì½”ë“œ ë³µì‚¬
            {
              "Version": "2012-10-17",
              "Statement": [
                {
                  "Effect": "Allow",
                  "Action": "s3:ListBucket",
                  "Resource": "arn:aws:s3:::*"
                }
              ]
            }
            
            ```
            
            ìœ„ ì •ì±…ì€ **IAM ì—­í• **ì´ ëª¨ë“  S3 ë²„í‚·ì„ ë‚˜ì—´í•  ìˆ˜ ìžˆëŠ” ê¶Œí•œì„ ë¶€ì—¬í•©ë‹ˆë‹¤. ì—¬ê¸°ì„œ ì¤‘ìš”í•œ ì ì€ ì •ì±…ì´ **IAM ì—­í• **ì— ë¶€ì°©ëœë‹¤ëŠ” ê²ƒìž…ë‹ˆë‹¤.
            
            ### 2. **ë¦¬ì†ŒìŠ¤ ê¸°ë°˜ ì •ì±… (Resource-Based Policy)**
            
            - **ì ìš© ëŒ€ìƒ**: AWS ë¦¬ì†ŒìŠ¤ ìžì²´ì— ë¶€ì°©ë©ë‹ˆë‹¤. S3 ë²„í‚·, SQS í, SNS ì£¼ì œ, KMS í‚¤ ë“±ì´ ë¦¬ì†ŒìŠ¤ ê¸°ë°˜ ì •ì±…ì„ ì‚¬ìš©í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.
            - **ì‚¬ìš© ë°©ë²•**: íŠ¹ì • ë¦¬ì†ŒìŠ¤ì— ëŒ€í•´ ì–´ë–¤ ì—”í„°í‹°(IAM ì‚¬ìš©ìž, ì—­í• , ë˜ëŠ” AWS ì„œë¹„ìŠ¤)ê°€ í•´ë‹¹ ë¦¬ì†ŒìŠ¤ì— ì ‘ê·¼í•  ìˆ˜ ìžˆëŠ”ì§€ë¥¼ ì •ì˜í•©ë‹ˆë‹¤.
            - **ì˜ˆì‹œ ìƒí™©**: "ì´ S3 ë²„í‚·ì— íŠ¹ì • IAM ì—­í• ë§Œ ì ‘ê·¼í•  ìˆ˜ ìžˆë„ë¡ ì„¤ì •"í•˜ëŠ” ê²½ìš° ë¦¬ì†ŒìŠ¤ ê¸°ë°˜ ì •ì±…ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
            
            **ì˜ˆì‹œ: S3 ë²„í‚·ì— ì ìš©ëœ ë¦¬ì†ŒìŠ¤ ê¸°ë°˜ ì •ì±…**
            
            ```JSON
            json
            ì½”ë“œ ë³µì‚¬
            {
              "Version": "2012-10-17",
              "Statement": [
                {
                  "Effect": "Allow",
                  "Principal": {
                    "AWS": "arn:aws:iam::123456789012:role/SomeIAMRole"
                  },
                  "Action": "s3:GetObject",
                  "Resource": "arn:aws:s3:::example-bucket/*"
                }
              ]
            }
            
            ```
            
            ìœ„ ì •ì±…ì€ **S3 ë²„í‚·**ì— ë¶€ì°©ëœ ë¦¬ì†ŒìŠ¤ ê¸°ë°˜ ì •ì±…ìœ¼ë¡œ, íŠ¹ì • IAM ì—­í• (`SomeIAMRole`)ë§Œ í•´ë‹¹ S3 ë²„í‚·ì˜ ê°ì²´ë¥¼ ì½ì„ ìˆ˜ ìžˆëŠ” ê¶Œí•œì„ ë¶€ì—¬í•©ë‹ˆë‹¤. ì—¬ê¸°ì„œ ì •ì±…ì´ S3 ë²„í‚· ë¦¬ì†ŒìŠ¤ì— ë¶€ì°©ëœë‹¤ëŠ” ì ì´ í•µì‹¬ìž…ë‹ˆë‹¤.
            
            ### 3. **ì°¨ì´ì  ìš”ì•½**
            
            - **ìžê²© ê¸°ë°˜ ì •ì±…**: IAM ì—”í„°í‹°(ì‚¬ìš©ìž, ê·¸ë£¹, ì—­í• )ì—ê²Œ ê¶Œí•œì„ ë¶€ì—¬í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, "ì´ IAM ì—­í• ì€ S3 ë²„í‚·ì— ì ‘ê·¼í•  ìˆ˜ ìžˆë‹¤"ì™€ ê°™ì€ í˜•íƒœë¡œ, ì •ì±…ì€ **ìœ ì €ë‚˜ ì—­í• ì— ì ìš©**ë©ë‹ˆë‹¤.
            - **ë¦¬ì†ŒìŠ¤ ê¸°ë°˜ ì •ì±…**: ë¦¬ì†ŒìŠ¤(S3 ë²„í‚·, SNS ì£¼ì œ, SQS í ë“±) ìžì²´ì— ë¶€ì°©ë©ë‹ˆë‹¤. ë¦¬ì†ŒìŠ¤ê°€ ì–´ë–¤ ì—”í„°í‹°ì—ê²Œ ì ‘ê·¼ ê¶Œí•œì„ ë¶€ì—¬í•˜ëŠ”ì§€ë¥¼ ì •ì˜í•©ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, "ì´ S3 ë²„í‚·ì€ íŠ¹ì • IAM ì—­í• ì´ ì ‘ê·¼í•  ìˆ˜ ìžˆë‹¤"ì™€ ê°™ì€ í˜•íƒœë¡œ, ì •ì±…ì€ **ê°œë³„ ë¦¬ì†ŒìŠ¤ì— ì ìš©**ë©ë‹ˆë‹¤.
            
            ### 4. **ì ìš© ì˜ˆì‹œ**
            
            ### ìžê²© ê¸°ë°˜ ì •ì±…
            
            - íŠ¹ì • IAM ì—­í• ì—ê²Œ EC2 ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì‹œìž‘í•˜ê³  ì¢…ë£Œí•  ìˆ˜ ìžˆëŠ” ê¶Œí•œì„ ë¶€ì—¬í•˜ë ¤ë©´, **ìžê²© ê¸°ë°˜ ì •ì±…**ì„ í•´ë‹¹ IAM ì—­í• ì— ë¶€ì°©í•©ë‹ˆë‹¤.
            
            ### ë¦¬ì†ŒìŠ¤ ê¸°ë°˜ ì •ì±…
            
            - íŠ¹ì • IAM ì—­í• ì´ **S3 ë²„í‚·**ì—ë§Œ ì ‘ê·¼í•  ìˆ˜ ìžˆë„ë¡ í•˜ë ¤ë©´, S3 ë²„í‚·ì— **ë¦¬ì†ŒìŠ¤ ê¸°ë°˜ ì •ì±…**ì„ ë¶€ì°©í•˜ì—¬ í•´ë‹¹ IAM ì—­í• ë§Œ ì ‘ê·¼í•  ìˆ˜ ìžˆë„ë¡ ì œí•œí•©ë‹ˆë‹¤.
            
            ### ì •ë¦¬
            
            - **ìžê²© ê¸°ë°˜ ì •ì±…**ì€ **IAM ì‚¬ìš©ìž, ê·¸ë£¹, ì—­í• **ì— ì ìš©ë˜ëŠ” ì •ì±…ìž…ë‹ˆë‹¤.
            - **ë¦¬ì†ŒìŠ¤ ê¸°ë°˜ ì •ì±…**ì€ **AWS ë¦¬ì†ŒìŠ¤ ìžì²´(S3, SNS, SQS ë“±)**ì— ì ìš©ë˜ë©°, íŠ¹ì • ì—”í„°í‹°ê°€ í•´ë‹¹ ë¦¬ì†ŒìŠ¤ì— ì–´ë–»ê²Œ ì ‘ê·¼í•  ìˆ˜ ìžˆëŠ”ì§€ë¥¼ ì œì–´í•©ë‹ˆë‹¤.
            
            ì´ ë‘ ì •ì±…ì„ ì ì ˆí•˜ê²Œ ì‚¬ìš©í•˜ë©´, ê¶Œí•œ ê´€ë¦¬ì—ì„œ ë³´ë‹¤ ì •êµí•œ í†µì œê°€ ê°€ëŠ¥í•©ë‹ˆë‹¤.
            
    - [DVA] CloudFormation - Capabilities
        
        ![[image 37 2.png]]
        
        **Capabilities (ëŠ¥ë ¥ë“¤)**
        
        - **CAPABILITY_NAMED_IAM, CAPABILITY_IAM**
            - CloudFormationì´ IAM ë¦¬ì†ŒìŠ¤ë¥¼ ë§Œë“¤ê±°ë‚˜ ì—…ë°ì´íŠ¸í•  ë•Œ í•„ìš”í•˜ë‹¤. (IAM ìœ ì €, ì—­í• , ì •ì±… ë“±)
            - ë¦¬ì†ŒìŠ¤ì˜ ì´ë¦„ì„ ì§€ì„ ê±°ë©´ CAPABILITY_NAMED_IAMì„ ì¨ë¼
        - **CAPABILITY_AUTO_EXPAND**
            - CloudFormationì´ Macrosë‚˜ Nested Stackê°€ ìžˆìœ¼ë©´ ì‚¬ìš©í•´ì•¼ í•œë‹¤.
        - **InsufficientCapabilitiesException**
            - ë§Œì•½, Capabilitiesê°€ ì—†ìœ¼ë©´ í•´ë‹¹ ì—ëŸ¬ê°€ ë‚œë‹¤.
        
        ```Bash
        # ì˜ˆì‹œ
        aws cloudformation \
        		create-stack \
        		--stack-name message-store \
        		--template-body file://bucket_with_keys.yaml \
        		--parameters file://cfg_bucket_with_keys.json \
        		--capabilities CAPABILITY_NAMED_IAM
        ```
        
    - [DVA] CloudFormation - Deletion Policy
        
        Deletion Policyëž€?
        
        - CloudFormation Templateì´ ì‚­ì œë˜ì—ˆê±°ë‚˜ ë¦¬ì†ŒìŠ¤ê°€ CloudFormation Templateì—ì„œ ì‚­ì œë˜ì—ˆì„ ë•Œ ì¡°ì ˆí•˜ëŠ” ì •ì±…
        - Extra Safety Measure(ì¶”ê°€ì ì¸ ë³´ì•ˆ ì¡°ì¹˜)ë¡œ ë¦¬ì†ŒìŠ¤ë¥¼ ë³´ì¡´í•˜ê³  ë°±ì—…í•œë‹¤.
        
        - DeletionPolicy Delete
            
            ![[image 38 2.png]]
            
            - ê¸°ë³¸ ì‚­ì œ ì •ì±…ì€ Deleteë‹¤.
            
              
            
        - DeletionPolicy Retain
            
            ![[image 39 2.png]]
            
            - ìœ ì§€í•˜ëŠ” ì •ì±…
        - DeletionPolicy Snapshot
            
            ![[image 40 2.png]]
            
            - ì‚­ì œí•˜ê¸° ì „ì— ìŠ¤ëƒ…ìƒ·ì„ ì°ëŠ”ë‹¤.
            - ê°€ëŠ¥í•œ ë¦¬ì†ŒìŠ¤:
                - EBS Volume
                - ElaticCache Cluster, ElasticCache ReplicationGroup
                - RDS DB Instance
                    - RDS DB Cluster
                    - Redshift Cluster
                    - Neptune DBCluster
                    - DocumentDB DBCluster
    - [DVA] CloudFormation - Stack Policy
        
        ![[image 41 2.png]]
        
        - ì—…ë°ì´íŠ¸ê°€ ì¼ì–´ë‚˜ë„ ë˜ëŠ” ë¦¬ì†ŒìŠ¤ë¥¼ ì •ì˜í•œë‹¤.
        - Stack Policyë¥¼ ìž‘ì„±í•˜ë©´ ë””í´íŠ¸ ê°’ìœ¼ë¡œ ëª¨ë“  ë¦¬ì†ŒìŠ¤ê°€ ë³´í˜¸ëœë‹¤.
        - Stack Policyë¥¼ ìž‘ì„±í•˜ë©´ ì—…ë°ì´íŠ¸ë¥¼ ì›í•˜ëŠ” ë¦¬ì†ŒìŠ¤ì—” ë¬´ì¡°ê±´ Allowë¥¼ ì¶”ê°€í•˜ë¼.
    - [DVA] CloudFormation - Termination Protection
        
        ![[image 42 2.png]]
        
        Termanation Protectionì„ í†µí•´ Stack ì‚­ì œë¥¼ ë°©ì§€í•  ìˆ˜ ìžˆë‹¤.
        
    - [DVA] CloudFormation - Custom Resources
        
        ![[image 43 2.png]]
        
        - CloudFormationì—ì„œ ì•„ì§ ì§€ì›í•˜ì§€ ì•ŠëŠ” ë¦¬ì†ŒìŠ¤ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œ ì •ì˜í•˜ëŠ” ê²ƒ
        
        ![[image 44 2.png]]
        
          
        
        > [!important]  
        > ARNì´ëž€? Amazon Resource Nameìœ¼ë¡œ ì•„ë§ˆì¡´ ë¦¬ì†ŒìŠ¤ì˜ ê³ ìœ í•œ ì‹ë³„ìž  
        
        ![[image 45.png]]
        
          
        
    - [DVA] CloudFormation - Dynamic References
        - Dynamic References
            
            ![[image 46.png]]
            
            - SSMì´ë‚˜ Secrets Managerì˜ ê°’ì„ CloudFormation ë‚´ì—ì„œ ì‚¬ìš©í•©ë‹ˆë‹¤.
            - create/update/delete ì˜¤í¼ë ˆì´ì…˜ ì¤‘ì— ê°’ë“¤ì„ ê°€ì ¸ì˜¬ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.
            - ì˜ˆ: í…œí”Œë¦¿ì„ í†µí•´ì„œ RDSë¥¼ ë§Œë“¤ ë•Œ, SMì—ì„œ ìœ ì €ì˜ íŒ¨ìŠ¤ì›Œë“œë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ìžˆë‹¤.
            - ì§€ì› ì˜ˆ:
                - ssm - Plain text
                - ssm-secure - SSMì—ì„œ ì•”í˜¸í™”ëœ String
                - secretsmanager - Secrets Managerì— ì €ìž¥ëœ ê°’
            
              
            
            ![[image 47.png]]
            
        - AWS System Manager vs AWS Secrets Manager
            - **ë¹„ìš©**: SSM Parameter StoreëŠ” í‘œì¤€ íŒŒë¼ë¯¸í„°ì— ëŒ€í•œ ë¬´ë£Œ ì œê³µì´ ìžˆì–´ ì†Œê·œëª¨ í”„ë¡œì íŠ¸ë‚˜ ê°„ë‹¨í•œ ì„¤ì • ê´€ë¦¬ì— ìœ ë¦¬í•©ë‹ˆë‹¤. ë°˜ë©´, Secrets ManagerëŠ” ìžë™ ë¹„ë°€ë²ˆí˜¸ ê°±ì‹  ê¸°ëŠ¥ì„ ì œê³µí•˜ë¯€ë¡œ ë³´ì•ˆì´ ì¤‘ìš”í•œ ì• í”Œë¦¬ì¼€ì´ì…˜ì— ì í•©í•˜ì§€ë§Œ ë¹„ìš©ì´ ë” ë†’ìŠµë‹ˆë‹¤.
            - **ìš©ëŸ‰**: Secrets ManagerëŠ” í•˜ë‚˜ì˜ ë¹„ë°€ì— ëŒ€í•´ ìµœëŒ€ 64KBë¥¼ ì§€ì›í•˜ë©°, Parameter StoreëŠ” ìµœëŒ€ 8KBê¹Œì§€ë§Œ ì €ìž¥í•  ìˆ˜ ìžˆìŠµë‹ˆë‹¤.
            - **ê¸°ëŠ¥**: Secrets ManagerëŠ” ìžë™ ë¹„ë°€ êµì²´ ë° ë” ë†’ì€ ë³´ì•ˆ ê´€ë¦¬ ê¸°ëŠ¥ì„ ì œê³µí•˜ëŠ” ë°˜ë©´, SSM Parameter StoreëŠ” ë” ë‹¨ìˆœí•œ ì„¤ì • ì •ë³´ ì €ìž¥ì„ ìœ„í•œ ì„œë¹„ìŠ¤ìž…ë‹ˆë‹¤.
        - Secrets Manager & RDS Setting
            
            ![[image 48.png]]
            
              
            
            ![[image 49.png]]
            
    - CloudFormation - User Data
        - User Data in EC2 for CloudFormation
            
            ![[image 50.png]]
            
            - Fn::Base64ë¡œ ì´ˆê¸°í™” ìŠ¤í¬ë¦½íŠ¸ë¥¼ EC2ì— ì „ë‹¬í•  ìˆ˜ ìžˆë‹¤.
            - User Data ìŠ¤í¬ë¦½íŠ¸ ë¡œê·¸ëŠ” /var/log/cloud-init-output.logì— ìž‘ì„±ëœë‹¤.
        - The Problems with EC2 User Data
            
            ![[image 51.png]]
            
            - ì„¤ì • íŒŒì¼ì´ ì—„ì²­ í´ ë•ŒëŠ” ì–´ë–»ê²Œí• ê¹Œ?
            - ì¸ìŠ¤í„´ìŠ¤ë¥¼ í”„ë¡œë¹„ì €ë‹ ê³¼ì •ì„ ê±°ì¹˜ì§€ ì•Šê³  ì‹¤í–‰ ì¤‘ì¸ ì¸ìŠ¤í„´ìŠ¤ë“¤ì€ ì–´ë–»ê²Œ UserDataë¥¼ ì‹¤í–‰í• ê¹Œ?
            - ì–´ë–»ê²Œ user-dataë¥¼ ë” ì½ê¸° ì‰½ê²Œ ë§Œë“¤ê¹Œ
            - ìŠ¤í¬ë¦½íŠ¸ ì„±ê³µ ì—¬ë¶€ëŠ” ì–´ë–»ê²Œ íŒŒì•…í• ê¹Œ?
            
              
            
            - ì´ë¥¼ í•´ê²°í•˜ëŠ” ê²ƒì´ CloudFormation Helper Scripts
                - cfn-init, cfn-signal ë“± ì—¬ëŸ¬ ì„¤ì • íŒŒì¼ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì œê³µí•œë‹¤.
    - CloudFormation - cfn-init
        
        ![[image 52.png]]
        
        - ìœ ì €ëª…, ê·¸ë£¹, íŒ¨í‚¤ì§€ ë“± ì¸ìŠ¤í„´ìŠ¤ì— ì´ˆê¸° ì„¤ì •ì— í•„ìš”í•œ ë‚´ìš©ë“¤ì„ YAML íŒŒì¼ì— ìž‘ì„±í•œë‹¤.
        
        ![[image 53.png]]
        
        - ë¦¬ì†ŒìŠ¤ë¥¼ íšë“í•˜ê³  ë¦¬ì†ŒìŠ¤ ë©”íƒ€ë°ì´í„°ë¥¼ í•´ì„í•˜ëŠ”ë° ì‚¬ìš©ëœë‹¤.
        - EC2 ì¸ìŠ¤í„´ìŠ¤ê°€ CloudFormationì— cfn-init ìŠ¤í¬ë¦½íŠ¸ë¥¼ ìš”ì²­í•˜ê³  ë°›ì€ í›„ì— ì‹¤í–‰í•œë‹¤.
        - ë¡œê·¸ëŠ” /var/log/cfn-init.logì— ìž‘ì„±ëœë‹¤.
    - CloudFormation - cfn-signal & Wait Condition
        
        ![[image 54.png]]
        
        - cfn-signalì„ í†µí•´ì„œ cfn-init ì„¤ì • ê²°ê³¼ë¥¼ CloudFormationìœ¼ë¡œ ë³´ë‚¼ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.
        - cfn-signalì„ ìœ„í•´ì„  WaitConditionì„ ìž‘ì„±í•´ì•¼ í•œë‹¤.
            - í…œí”Œë¦¿ ë™ìž‘ì„ ëª…ì‹œí•œ WaitConditionì´ ëë‚˜ê¸° ì „ê¹Œì§€ Blockí•œë‹¤.
            - WaitConditionì—” Creation Policyë¥¼ ëª…ì‹œí•œë‹¤. (EC2ì™€ ASGì—ì„œë„ ë™ìž‘í•œë‹¤.)
            - Countë¥¼ ì‚¬ìš©í•˜ì—¬ WaitConditionì´ ëë‚˜ëŠ” ì¡°ê±´ì¸ cfn-signal ìˆ˜ì‹  ê°œìˆ˜ë¥¼ ëª…ì‹œí•œë‹¤.
    - CloudFormation - cfn-signal Failures
        
        ![[image 55.png]]
        
        - cfn-initê³¼ cfn-signalì´ ì •ìƒì ìœ¼ë¡œ ë™ìž‘í–ˆëŠ”ì§€ /var/log/cloud-init.logë‚˜ /var/log/cfn-init.logì—ì„œ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤.
        - ë‹¨, CloudFormationì˜ ì‹¤íŒ¨ ì‹œì— ë¡¤ë°± ê¸°ëŠ¥ì„ êº¼ì•¼ í•©ë‹ˆë‹¤.
        - ì¸ìŠ¤í„´ìŠ¤ê°€ ì¸í„°ë„·ê³¼ ì—°ê²°ëëŠ”ì§€ í™•ì¸í•˜ì„¸ìš”.
    - CloudFormation - Nested Stacks
        - Nested Stacks
            
            ![[image 56.png]]
            
            - ì¤‘ì²© ìŠ¤íƒì€ ìŠ¤íƒ ë‚´ì—ì„œ ë˜ ë‹¤ë¥¸ ìŠ¤íƒì˜ ìŠ¤íƒ ì—­í• ì„ í•©ë‹ˆë‹¤.
            - ë°˜ë³µë˜ëŠ” íŒ¨í„´ê³¼ ê³µí†µ ì»´í¬ë„ŒíŠ¸ë¥¼ ê²©ë¦¬í™”í•˜ì—¬ ë˜ ë‹¤ë¥¸ ìŠ¤íƒì—ì„œ ê²©ë¦¬ëœ ì»´í¬ë„ŒíŠ¸ë“¤ì„ í˜¸ì¶œí•©ë‹ˆë‹¤.
            - ì¤‘ì²© ìŠ¤íƒì„ ì—…ë°ì´íŠ¸í•˜ê¸° ìœ„í•´ì„  root stackì„ ì—…ë°ì´íŠ¸í•´ì•¼ í•©ë‹ˆë‹¤.
        - ì—¬ëŸ¬ ìŠ¤íƒì„ ì‚¬ìš©í•˜ëŠ” ë°©ë²• ë‘ ê°€ì§€ Cross Stacks vs Nested Stacks
            
            ![[image 57.png]]
            
            - **Cross Stacks**
                - ìŠ¤íƒë“¤ì´ ì„œë¡œ ë‹¤ë¥¸ ë¼ì´í”„ ì‚¬ì´í´ì„ ê°€ì§ˆ ë•Œ ë„ì›€ì´ ëœë‹¤.
                - Outputs Exportë¥¼ í†µí•´ ìŠ¤íƒì—ì„œ ê°’ì„ ì¶œë ¥í•˜ê³  ImportValueë¥¼ í†µí•´ ê°’ì„ ìž…ë ¥ ë°›ëŠ”ë‹¤.
                - VPC Idì™€ ê°™ì€ ê°’ë“¤ì„ ì—¬ëŸ¬ ìŠ¤íƒì— ì „ë‹¬í•  í•„ìš”ê°€ ìžˆì„ ë•Œ ì‚¬ìš©
            - Nested Stacks
                - ë™ì¼í•œ ì„¤ì •ì˜ componentë¥¼ ìž¬ì‚¬ìš©í•  ë•Œ ë„ì›€ëœë‹¤. (ë™ì¼í•œ ì˜¤ë¸Œì íŠ¸ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²Œ ì•„ë‹ˆë¼ ë™ì¼í•œ ì„¤ì •ì„ ê°€ì§„ Componentë¥¼ ë§Œë“¤ì–´ì„œ ì‚¬ìš©í•˜ëŠ” ê²ƒ)
                - ì˜ˆ: ALBì„ ì–´ë–»ê²Œ ì ì ˆí•˜ê²Œ ì„¤ì •í• ì§€ ìž¬ì‚¬ìš©
                - ì¤‘ì²© ìŠ¤íƒì€ ìƒìœ„ ìŠ¤íƒì—ë§Œ ì¤‘ìš”í•©ë‹ˆë‹¤. (ëª¨ë“  ì¤‘ì²© ìŠ¤íƒë“¤ì€ ìƒìœ„ ìŠ¤íƒì— ì˜í•´ì„œ ê´€ë¦¬ëœë‹¤.)
    - CloudFormation - Depends On
        - DependsOn
            
            ![[image 58.png]]
            
            - íŠ¹ì • ë¦¬ì†ŒìŠ¤ê°€ ë§Œë“¤ì–´ì§„ í›„ì— ë¦¬ì†ŒìŠ¤ë¥¼ ë§Œë“¤ê¸° ìœ„í•´ ì‚¬ìš©
            - GetAttë‚˜ Refë¥¼ ì‚¬ìš©í•˜ë©´ ìžë™ìœ¼ë¡œ í•´ë‹¹ ë¦¬ì†ŒìŠ¤ì˜ DependOní•˜ëŠ” íš¨ê³¼ë¥¼ ë°œíœ˜í•œë‹¤.
    - CloudFormation - StackSets
        - StackSets
            
            ![[image 59.png]]
            
            - StackSetsë¥¼ ì‚¬ìš©í•´ì„œ ì—¬ëŸ¬ ê³„ì •, Regionì˜ Stackì„ í•œ ë²ˆì— ìˆ˜ì •í•  ìˆ˜ ìžˆë‹¤.
            - Administrator ê³„ì •ì„ ì‚¬ìš©í•´ì„œ StackSetsë¥¼ ë§Œë“¤ ìˆ˜ ìžˆë‹¤.
            - StackSetsë¥¼ ì—…ë°ì´íŠ¸í•˜ë©´ ëª¨ë“  ì—°ê²°ëœ Stackë“¤ì´ ì—…ë°ì´íŠ¸ëœë‹¤.
        - StackSets Permission Models
            
            ![[image 60.png]]
            
            **StackSets ê¶Œí•œ ëª¨ë¸(Permission Models)**
            
            - Self-Managed Permissions (AWS Organizationì„ ì•ˆ ì“°ëŠ” ê²½ìš°)
                - Administratorì™€ íƒ€ê²Ÿ ìœ ì € ê³„ì •ì— IAM ì—­í• (Administration Role, Execution Role)ì„ ë§Œë“ ë‹¤.
                - ìœ„ì²˜ëŸ¼ ì—­í• ì„ ê°€ì¡Œë‹¤ë©´ í•´ë‹¹ ê³„ì •ì— Stackì„ ë§Œë“¤ ìˆ˜ ìžˆìŠµë‹ˆë‹¤.
            - Service-managed Permissions(AWS Organizationì„ ì“°ëŠ” ê²½ìš°)
                - AWS Organizationì„ í†µí•´ ê´€ë¦¬ë˜ëŠ” ê³„ì •ë“¤ì— ë°°í¬í•©ë‹ˆë‹¤.
                - AWS Organizationì— **trusted access**ë¥¼ í™œì„±í™”í•˜ë©´ StackSetsëŠ” ì•Œì•„ì„œ IAM ì—­í• ì„ ë§Œë“­ë‹ˆë‹¤.
                - **ë°˜ë“œì‹œ** AWS Organizationsì—ì„œ ëª¨ë“  ê¸°ëŠ¥ì„ Enableí•´ì•¼ í•©ë‹ˆë‹¤.
            
              
            
        - StackSets with AWS Organizations
            
            ![[image 61.png]]
            
            - ìƒˆë¡œìš´ ê³„ì •ì´ Organizationì— ì¶”ê°€ë˜ë©´ ìžë™ìœ¼ë¡œ í•´ë‹¹ ìŠ¤íƒë„ ë°°í¬í•œë‹¤.
            - StackSet ì–´ë“œë¯¼ ê¶Œí•œì„ Organizationì— ìœ„ìž„ ê°€ëŠ¥í•˜ë‹¤.
            - Trusted Accessê°€ ë°˜ë“œì‹œ í™œì„±í™” ë˜ì–´ ìžˆì–´ì•¼ í•œë‹¤.
            
            ![[image 62.png]]
            
              
            
        - Hands-On: StackSets
            
            ![[image 63.png]]
            
              
            
        - **Troubleshooting**
            - Troubleshooting
                
                ![[image 64.png]]
                
                **CloudFormation íŠ¸ëŸ¬ë¸” ìŠˆíŒ…**
                
                - DELETE_FAILED
                    - S3 ê°™ì€ ì• ë“¤ì€ ë¨¼ì € ë‚´ìš©ë¬¼(ë²„í‚·)ì´ ë¹„ì–´ì•¼ í•œë‹¤.
                        - Lambdaë¡œ ë²„í‚· ë‚´ìš© ë¹„ìš°ê¸°ë¥¼ ìžë™í™”í•´ë¼
                    - Security Groupì„ ì‚­ì œí•˜ê¸° ì „ì— ë¨¼ì € ëª¨ë“  EC2ë¥¼ ì‚­ì œí•´ì•¼ í•œë‹¤.
                    - íŠ¹ì • ë¦¬ì†ŒìŠ¤ ì‚­ì œê°€ ê³„ì† ì‹¤íŒ¨í•œë‹¤ë©´ DeletionPolicyë¥¼ Retainìœ¼ë¡œ ë‘¬ì„œ ìŠ¤í‚µí•  ìˆ˜ë„ ìžˆë‹¤. â†’ ìˆ˜ë™ ì‚­ì œí•´ì•¼í•¨
                - UPDATE_ROLLBACK_FAILED(ì—…ë°ì´íŠ¸ì— ì‹¤íŒ¨í•˜ê³  ë¡¤ë°±ì„ í•˜ë ¤í–ˆì§€ë§Œ ë¡¤ë°±ë„ ì‹¤íŒ¨í•œ ê²½ìš°)
                    - CloudFormation ì™¸ë¶€ì—ì„œ ë¬¸ì œê°€ ë°œìƒí•œ ê²½ìš°, ê¶Œí•œì´ ë¶€ì¡±í•œ ê²½ìš°, ASGê°€ ì¶©ë¶„í•œ Signalì„ ë°›ì§€ ëª»í•œ ê²½ìš°
                    - ìˆ˜ë™ìœ¼ë¡œ ê³ ì¹˜ê³  ContinueUpdateRollbackì„ ì‹¤í–‰í•˜ì‹œì˜¤.(ë¡¤ë°±ì„ ë§ˆì € ì§„í–‰í•¨)
            - StackSet Troubleshooting
                
                ![[image 65.png]]
                
                **CloudFormation - StackSet Troubleshooting**
                
                - ìŠ¤íƒì´ ìž‘ì—…ì— ì‹¤íŒ¨í–ˆê³ , ìŠ¤íƒ ì¸ìŠ¤í„´ìŠ¤ì˜ ìƒíƒœê°€ OUTDATEDë©´
                    - íƒ€ê²Ÿ ê³„ì •ì˜ ì¶©ë¶„í•œ ê¶Œí•œì´ ì—†ì–´ì„œ ë¦¬ì†ŒìŠ¤ë¥¼ ë§Œë“¤ ìˆ˜ ì—†ëŠ” ê²½ìš°
                    - ê¸€ë¡œë²Œ ë¦¬ì†ŒìŠ¤ë¼ì„œ Uniqueí•´ì•¼ í•˜ëŠ”ë° Uniqueí•˜ì§€ ì•Šê²Œ ëª…ì‹œí•´ì„œ(ì˜ˆ: S3ëª…)
                    - Admin ê³„ì •ê³¼ target ê³„ì •ì´ trust Relationì´ ì—†ì–´ì„œ(Admin Role, Execution Role)
                    - Target ê³„ì •ì˜ ë¦¬ì†ŒìŠ¤ê°€ ë„ˆë¬´ ë§Žì•„ì„œ Limitë¥¼ ì´ˆê³¼í•œ ê²½ìš°

### í•µì‹¬ ìš”ì•½

- í•µì‹¬ ìš”ì•½ ì ‘ê¸°
    
    â€¢ CloudFormationì€ AWS ë¦¬ì†ŒìŠ¤ë¥¼ ì½”ë“œë¡œ ê´€ë¦¬í•˜ëŠ” IaC(Infrastructure as Code) ì„œë¹„ìŠ¤ì´ë‹¤.
    
    â€¢ í…œí”Œë¦¿ì„ í†µí•´ ë¦¬ì†ŒìŠ¤ë¥¼ ì„ ì–¸ì ìœ¼ë¡œ ì •ì˜í•˜ê³ , ìŠ¤íƒìœ¼ë¡œ ë¦¬ì†ŒìŠ¤ ê·¸ë£¹ì„ ê´€ë¦¬í•œë‹¤.
    
    â€¢ cfn-init, cfn-signal, WaitCondition ë“±ì„ í†µí•´ ì¸ìŠ¤í„´ìŠ¤ ì´ˆê¸° ì„¤ì •ê³¼ ìƒíƒœ í™•ì¸ì´ ê°€ëŠ¥í•˜ë‹¤.
    
    â€¢ ì¤‘ì²© ìŠ¤íƒ(Nested Stacks)ì„ ì‚¬ìš©í•´ ê³µí†µ ì»´í¬ë„ŒíŠ¸ë¥¼ ìž¬ì‚¬ìš©í•  ìˆ˜ ìžˆë‹¤.
    
    â€¢ Cross Stacksë¥¼ í†µí•´ ìŠ¤íƒ ê°„ ê°’ì„ ê³µìœ í•˜ê³ , ë‹¤ë¥¸ ë¼ì´í”„ì‚¬ì´í´ì„ ê°€ì§„ ìŠ¤íƒì„ ê´€ë¦¬í•  ìˆ˜ ìžˆë‹¤.
    
    â€¢ StackSetsë¥¼ ì‚¬ìš©í•˜ì—¬ ì—¬ëŸ¬ ê³„ì •ê³¼ ë¦¬ì „ì— ê±¸ì³ ìŠ¤íƒì„ ë°°í¬í•˜ê³  ê´€ë¦¬í•  ìˆ˜ ìžˆë‹¤.
    
    â€¢ íŠ¸ëŸ¬ë¸”ìŠˆíŒ… ì‹œ ë¡œê·¸ í™•ì¸, ê¶Œí•œ ê²€ì¦, ë¦¬ì†ŒìŠ¤ ì œí•œ í™•ì¸ ë“±ì´ ì¤‘ìš”í•˜ë‹¤.
    
    â€¢ CloudFormationì˜ DependsOn ì†ì„±ì„ ì‚¬ìš©í•˜ì—¬ ë¦¬ì†ŒìŠ¤ ê°„ì˜ ì¢…ì†ì„±ì„ ëª…ì‹œì ìœ¼ë¡œ ì •ì˜í•  ìˆ˜ ìžˆë‹¤.
    
    â€¢ CloudFormation Designerë¥¼ í™œìš©í•˜ë©´ ì‹œê°ì ìœ¼ë¡œ í…œí”Œë¦¿ì„ ìƒì„±í•˜ê³  ìˆ˜ì •í•  ìˆ˜ ìžˆì–´ ë³µìž¡í•œ ì•„í‚¤í…ì²˜ ì„¤ê³„ê°€ ìš©ì´í•˜ë‹¤.
    
    â€¢ ë³€ê²½ ì„¸íŠ¸(Change Sets)ë¥¼ í†µí•´ ìŠ¤íƒ ì—…ë°ì´íŠ¸ ì „ ë³€ê²½ ì‚¬í•­ì„ ë¯¸ë¦¬ ê²€í† í•˜ê³  ì˜í–¥ì„ í‰ê°€í•  ìˆ˜ ìžˆë‹¤.
    
      
    

### ë³µìŠµì•Œë¦¼

- 
- ìžë™ìœ¼ë¡œ í•¸ë“œí°ì— ì•Œë¦¼ì´ ì˜¤ë„ë¡ ì„¤ì •í•˜ê³  ì‹¶ìœ¼ë©´ ë‹¤ìŒê³¼ ê°™ì´ í•œë‹¤.

> [!important]  
> 